{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Copy of FinalProject (Transformers Part).ipnyb","provenance":[{"file_id":"1xp4JSy7hfJUBcTeSAaqwon4cur4a7Kej","timestamp":1619810677650}],"collapsed_sections":[],"toc_visible":true},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"91a731f098024fa39add4f94faeeb10e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_613efca4f8db4834b30ae5baea57ba11","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_49681ab8a5d944be87cf18a72c16d433","IPY_MODEL_7c92455760a24a478cd4376cdcff2a45"]}},"613efca4f8db4834b30ae5baea57ba11":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"49681ab8a5d944be87cf18a72c16d433":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_1d7c0716c04242d58137cda6bdaeafdf","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":433,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":433,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_eb2225cfa61b43f88cfe300a59d9712d"}},"7c92455760a24a478cd4376cdcff2a45":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f9e56e405b0a4ad8a01aca7882d2e7bc","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 433/433 [00:11&lt;00:00, 39.3B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b375b3b4bdcc4bf58d1e58c1a0500b05"}},"1d7c0716c04242d58137cda6bdaeafdf":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"eb2225cfa61b43f88cfe300a59d9712d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f9e56e405b0a4ad8a01aca7882d2e7bc":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b375b3b4bdcc4bf58d1e58c1a0500b05":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"bec05a68695746b1bbdf26ecb1f7d595":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5e208480b2d74e86814211cc1fe221c5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_84aae9d3e3684ca9ad1c8845d640e052","IPY_MODEL_c2890180dbbc44a7bbe1f8010890f95d"]}},"5e208480b2d74e86814211cc1fe221c5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"84aae9d3e3684ca9ad1c8845d640e052":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_009edcf0858b4819b59c4d6efd269a19","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":440473133,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":440473133,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_40d48b6c759b49f5b7c22c84de54059c"}},"c2890180dbbc44a7bbe1f8010890f95d":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b2a580b9e08b487ca070d228fe08d230","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 440M/440M [00:08&lt;00:00, 49.0MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f31713c5f4bd4ce8added6a72a1fa980"}},"009edcf0858b4819b59c4d6efd269a19":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"40d48b6c759b49f5b7c22c84de54059c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b2a580b9e08b487ca070d228fe08d230":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f31713c5f4bd4ce8added6a72a1fa980":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fc4c5d35db7f451ca995c38ad890163c":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1a6b71247bf44927b2a0b989733b4979","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4f4455d5b9df4bfe831caf3d486bc3e9","IPY_MODEL_0d28697acf8247188df1615d7632fc8b"]}},"1a6b71247bf44927b2a0b989733b4979":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4f4455d5b9df4bfe831caf3d486bc3e9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_cb5006f8b56f4f4ea09d419c0c276f92","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":231508,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":231508,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cff6f9bb7365429dbe61cb475594e903"}},"0d28697acf8247188df1615d7632fc8b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e5a62c5c73694e30b364e626ab58cc28","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 232k/232k [00:07&lt;00:00, 30.3kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a5ce3547546049179c5c9e21092fbb1e"}},"cb5006f8b56f4f4ea09d419c0c276f92":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"cff6f9bb7365429dbe61cb475594e903":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e5a62c5c73694e30b364e626ab58cc28":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a5ce3547546049179c5c9e21092fbb1e":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"code","metadata":{"id":"7gFIpLfOdQjt","executionInfo":{"status":"ok","timestamp":1619814204779,"user_tz":-420,"elapsed":617,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":[" # imports\n","# !pip install spacy==2.3.5\n","# !python -m spacy download en_core_web_sm\n","# !python -m spacy download en\n","# import spacy\n"],"execution_count":1,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"bhORrLif8YUS","executionInfo":{"status":"ok","timestamp":1619834531434,"user_tz":-420,"elapsed":5577,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"d356c211-2363-44df-a9ef-468363702d98"},"source":["import pandas as pd\n","import numpy as np\n","import re\n","import string\n","import nltk\n","import matplotlib.pyplot as plt\n","import spacy\n","\n","from nltk.sentiment.vader import SentimentIntensityAnalyzer as SIA\n","nltk.download('punkt')\n","\n","import warnings\n","warnings.filterwarnings(\"ignore\")"],"execution_count":1,"outputs":[{"output_type":"stream","text":["/usr/local/lib/python3.7/dist-packages/nltk/twitter/__init__.py:20: UserWarning: The twython library has not been installed. Some functionality from the twitter package will not be available.\n","  warnings.warn(\"The twython library has not been installed. \"\n"],"name":"stderr"},{"output_type":"stream","text":["[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Unzipping tokenizers/punkt.zip.\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":189},"id":"Td4WQUGr7t4k","executionInfo":{"status":"ok","timestamp":1619834531436,"user_tz":-420,"elapsed":4092,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"fa470559-65d8-49dc-9508-f3a9e0d362f1"},"source":["data = pd.read_csv('reddit_wsb.csv')\n","data.head()\n","\n","# nyseStocks = pd.read_csv('nyse.csv')\n","# nasdaqStocks = pd.read_csv('nasdaq.csv')\n","\n","data.head()"],"execution_count":2,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>score</th>\n","      <th>id</th>\n","      <th>url</th>\n","      <th>comms_num</th>\n","      <th>created</th>\n","      <th>body</th>\n","      <th>timestamp</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>It's not about the money, it's about sending a...</td>\n","      <td>55</td>\n","      <td>l6ulcx</td>\n","      <td>https://v.redd.it/6j75regs72e61</td>\n","      <td>6</td>\n","      <td>1611862661</td>\n","      <td>NaN</td>\n","      <td>1/28/2021 21:37</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Math Professor Scott Steiner says the numbers ...</td>\n","      <td>110</td>\n","      <td>l6uibd</td>\n","      <td>https://v.redd.it/ah50lyny62e61</td>\n","      <td>23</td>\n","      <td>1611862330</td>\n","      <td>NaN</td>\n","      <td>1/28/2021 21:32</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Exit the system GME</td>\n","      <td>0</td>\n","      <td>l6uhhn</td>\n","      <td>https://www.reddit.com/r/wallstreetbets/commen...</td>\n","      <td>47</td>\n","      <td>1611862235</td>\n","      <td>The CEO of NASDAQ pushed to halt trading “to g...</td>\n","      <td>1/28/2021 21:30</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>NEW SEC FILING FOR GME! CAN SOMEONE LESS RETAR...</td>\n","      <td>29</td>\n","      <td>l6ugk6</td>\n","      <td>https://sec.report/Document/0001193125-21-019848/</td>\n","      <td>74</td>\n","      <td>1611862137</td>\n","      <td>NaN</td>\n","      <td>1/28/2021 21:28</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Not to distract from GME, just thought our AMC...</td>\n","      <td>71</td>\n","      <td>l6ufgy</td>\n","      <td>https://i.redd.it/4h2sukb662e61.jpg</td>\n","      <td>156</td>\n","      <td>1611862016</td>\n","      <td>NaN</td>\n","      <td>1/28/2021 21:26</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                               title  ...        timestamp\n","0  It's not about the money, it's about sending a...  ...  1/28/2021 21:37\n","1  Math Professor Scott Steiner says the numbers ...  ...  1/28/2021 21:32\n","2                                Exit the system GME  ...  1/28/2021 21:30\n","3  NEW SEC FILING FOR GME! CAN SOMEONE LESS RETAR...  ...  1/28/2021 21:28\n","4  Not to distract from GME, just thought our AMC...  ...  1/28/2021 21:26\n","\n","[5 rows x 8 columns]"]},"metadata":{"tags":[]},"execution_count":2}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"cltwpyFcNy07","executionInfo":{"status":"ok","timestamp":1619834531922,"user_tz":-420,"elapsed":3174,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"8de63611-8304-4ee8-937c-cada341c01c2"},"source":["data['length'] = [len(i.split()) for i in data['title']]\n","data['length'].min()"],"execution_count":3,"outputs":[{"output_type":"execute_result","data":{"text/plain":["1"]},"metadata":{"tags":[]},"execution_count":3}]},{"cell_type":"code","metadata":{"id":"REe13V1PPObG","executionInfo":{"status":"ok","timestamp":1619834531923,"user_tz":-420,"elapsed":2199,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["#Contains a list of every ticker tape used on the NYSE and NASDAQ\n","# stocks = set(nyseStocks['Symbol'])\n","# stocks.update(set(nasdaqStocks['Symbol']))\n"],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"ofRSU934OG_a","executionInfo":{"status":"ok","timestamp":1619834531923,"user_tz":-420,"elapsed":1046,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["data = data[data['length'] > 3].copy()"],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"DjZ6gumpOq84","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1619834532644,"user_tz":-420,"elapsed":626,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"bfb9e19c-c97b-42a9-fc5a-fe550c693fe0"},"source":["data['length'].min()"],"execution_count":6,"outputs":[{"output_type":"execute_result","data":{"text/plain":["4"]},"metadata":{"tags":[]},"execution_count":6}]},{"cell_type":"code","metadata":{"id":"qi12JGJRYORC","executionInfo":{"status":"ok","timestamp":1619834534078,"user_tz":-420,"elapsed":550,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["def isUppercase(word):\n","  return word.isupper()"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"n941Jn3s-fgi","executionInfo":{"status":"ok","timestamp":1619834538847,"user_tz":-420,"elapsed":4111,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["#RUN ONLY ONCE.  DATA IS IN title_data.csv \n","\n","title_data = data[['title','timestamp']].copy()\n","title_data = title_data.dropna()\n","nlp = spacy.load(\"en_core_web_sm\")\n","\n","# tickerList = []\n","\n","# for index, row in title_data.iterrows():\n","#   words = nlp(row['title'])\n","#   token_list = [token.orth_ for token in words]\n","#   wordset = set(filter(isUppercase, token_list))\n","#   tempTickers = (wordset.intersection(stocks))\n","#   #print(tempTickers)\n","#   tickerList.append(tempTickers)\n","#   #title_data[index, 'stocks'] = tempTickers\n","# print(tickerList)\n","# title_data['tickers'] = pd.Series(tickerList).values\n","\n","title_data.title = title_data.title.str.lower()\n","title_data.title = title_data.title.apply(lambda x:re.sub('@[^\\s]+','',x))\n","title_data.title = title_data.title.apply(lambda x:re.sub(r\"http\\S+\", \"\", x))\n","title_data.timestamp = pd.to_datetime(title_data.timestamp).dt.date"],"execution_count":8,"outputs":[]},{"cell_type":"code","metadata":{"id":"i_7Q24b1-j-v","executionInfo":{"status":"ok","timestamp":1619834538848,"user_tz":-420,"elapsed":2190,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["#Download the code for the first time after running the prev block\n","\n","# title_data.head()\n","\n","# from google.colab import files\n","\n","# title_data.to_csv('title_data.csv')\n","\n","# files.download(\"title_data.csv\")"],"execution_count":9,"outputs":[]},{"cell_type":"code","metadata":{"id":"jEmc0YdxL_f7","executionInfo":{"status":"ok","timestamp":1619834538849,"user_tz":-420,"elapsed":551,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["# title_data = pd.read_csv('title_data.csv')"],"execution_count":10,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":205},"id":"Ykl9RFvR-2o7","executionInfo":{"status":"ok","timestamp":1619834546114,"user_tz":-420,"elapsed":7320,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"a525efdb-4ddf-4d8a-af65-32f31062e750"},"source":["import nltk\n","nltk.download('vader_lexicon')\n","\n","sid = SIA()\n","\n","title_data['sentiments'] = title_data['title'].apply(lambda x: sid.polarity_scores(' '.join(re.findall(r'\\w+',x.lower()))))\n","title_data['Positive Sentiment'] = title_data['sentiments'].apply(lambda x: x['pos']+1*(10**-6)) \n","title_data['Neutral Sentiment'] = title_data['sentiments'].apply(lambda x: x['neu']+1*(10**-6))\n","title_data['Negative Sentiment'] = title_data['sentiments'].apply(lambda x: x['neg']+1*(10**-6))\n","title_data.drop(columns=['sentiments'],inplace=True)\n","title_data.head()"],"execution_count":11,"outputs":[{"output_type":"stream","text":["[nltk_data] Downloading package vader_lexicon to /root/nltk_data...\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>timestamp</th>\n","      <th>Positive Sentiment</th>\n","      <th>Neutral Sentiment</th>\n","      <th>Negative Sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>it's not about the money, it's about sending a...</td>\n","      <td>2021-01-28</td>\n","      <td>0.000001</td>\n","      <td>1.000001</td>\n","      <td>0.000001</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>math professor scott steiner says the numbers ...</td>\n","      <td>2021-01-28</td>\n","      <td>0.000001</td>\n","      <td>0.728001</td>\n","      <td>0.272001</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>exit the system gme</td>\n","      <td>2021-01-28</td>\n","      <td>0.000001</td>\n","      <td>1.000001</td>\n","      <td>0.000001</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>new sec filing for gme! can someone less retar...</td>\n","      <td>2021-01-28</td>\n","      <td>0.138001</td>\n","      <td>0.658001</td>\n","      <td>0.204001</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>not to distract from gme, just thought our amc...</td>\n","      <td>2021-01-28</td>\n","      <td>0.119001</td>\n","      <td>0.881001</td>\n","      <td>0.000001</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                               title  ... Negative Sentiment\n","0  it's not about the money, it's about sending a...  ...           0.000001\n","1  math professor scott steiner says the numbers ...  ...           0.272001\n","2                                exit the system gme  ...           0.000001\n","3  new sec filing for gme! can someone less retar...  ...           0.204001\n","4  not to distract from gme, just thought our amc...  ...           0.000001\n","\n","[5 rows x 5 columns]"]},"metadata":{"tags":[]},"execution_count":11}]},{"cell_type":"code","metadata":{"id":"Xg8BxpVz_t6X","executionInfo":{"status":"ok","timestamp":1619834546116,"user_tz":-420,"elapsed":5476,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["title_data['class_name'] = title_data[['Positive Sentiment', 'Neutral Sentiment', 'Negative Sentiment']].idxmax(axis=1)"],"execution_count":12,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":189},"id":"E0HqcKjp_xE-","executionInfo":{"status":"ok","timestamp":1619834546117,"user_tz":-420,"elapsed":4807,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"a4c9659e-b532-4c86-8db4-6f21c610e995"},"source":["data = title_data[title_data['class_name'] != 'Neutral Sentiment']\n","data.reset_index(drop=True, inplace=True)\n","data.head(5)"],"execution_count":13,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>timestamp</th>\n","      <th>Positive Sentiment</th>\n","      <th>Neutral Sentiment</th>\n","      <th>Negative Sentiment</th>\n","      <th>class_name</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>i love you retards!!!!</td>\n","      <td>2021-01-28</td>\n","      <td>0.677001</td>\n","      <td>0.323001</td>\n","      <td>0.000001</td>\n","      <td>Positive Sentiment</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>the wallstreetbets war museum</td>\n","      <td>2021-01-28</td>\n","      <td>0.000001</td>\n","      <td>0.435001</td>\n","      <td>0.565001</td>\n","      <td>Negative Sentiment</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>this took me longer than i'd like to admit. en...</td>\n","      <td>2021-01-28</td>\n","      <td>0.517001</td>\n","      <td>0.483001</td>\n","      <td>0.000001</td>\n","      <td>Positive Sentiment</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>most recent short interest</td>\n","      <td>2021-01-28</td>\n","      <td>0.521001</td>\n","      <td>0.479001</td>\n","      <td>0.000001</td>\n","      <td>Positive Sentiment</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>i love the movies: part 1</td>\n","      <td>2021-01-28</td>\n","      <td>0.583001</td>\n","      <td>0.417001</td>\n","      <td>0.000001</td>\n","      <td>Positive Sentiment</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                               title  ...          class_name\n","0                             i love you retards!!!!  ...  Positive Sentiment\n","1                      the wallstreetbets war museum  ...  Negative Sentiment\n","2  this took me longer than i'd like to admit. en...  ...  Positive Sentiment\n","3                         most recent short interest  ...  Positive Sentiment\n","4                          i love the movies: part 1  ...  Positive Sentiment\n","\n","[5 rows x 6 columns]"]},"metadata":{"tags":[]},"execution_count":13}]},{"cell_type":"code","metadata":{"id":"xNvglZBN_yk0","executionInfo":{"status":"ok","timestamp":1619834546118,"user_tz":-420,"elapsed":3268,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["data['class_name'][data['class_name'] == 'Negative Sentiment'] = 0\n","data['class_name'][data['class_name'] == 'Positive Sentiment'] = 1\n","data.rename(columns={'class_name':'class'}, inplace=True)"],"execution_count":14,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":189},"id":"F_t8VgGp_0vr","executionInfo":{"status":"ok","timestamp":1619834546118,"user_tz":-420,"elapsed":2538,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"c770d24f-79f5-490c-8998-51a5da3d0f3b"},"source":["data = data[['title','class']].copy()\n","data.head()"],"execution_count":15,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>title</th>\n","      <th>class</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>i love you retards!!!!</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>the wallstreetbets war museum</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>this took me longer than i'd like to admit. en...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>most recent short interest</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>i love the movies: part 1</td>\n","      <td>1</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                               title class\n","0                             i love you retards!!!!     1\n","1                      the wallstreetbets war museum     0\n","2  this took me longer than i'd like to admit. en...     1\n","3                         most recent short interest     1\n","4                          i love the movies: part 1     1"]},"metadata":{"tags":[]},"execution_count":15}]},{"cell_type":"code","metadata":{"id":"inlu_nafMVSz","executionInfo":{"status":"ok","timestamp":1619834546119,"user_tz":-420,"elapsed":1289,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["data['length'] = [len(i.split()) for i in data['title']]"],"execution_count":16,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"AMjvAv5ZNe20","executionInfo":{"status":"ok","timestamp":1619834546120,"user_tz":-420,"elapsed":829,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"bdf8f3a6-1a11-4734-c4be-aff9e5cffe03"},"source":["data['length'].min()"],"execution_count":17,"outputs":[{"output_type":"execute_result","data":{"text/plain":["3"]},"metadata":{"tags":[]},"execution_count":17}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"srerP-ZpSmFF","executionInfo":{"status":"ok","timestamp":1619834552152,"user_tz":-420,"elapsed":5720,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"d1e6ea3c-0e4a-4d40-9fa8-7cd664c7243a"},"source":["!pip install transformers==3.0"],"execution_count":18,"outputs":[{"output_type":"stream","text":["Collecting transformers==3.0\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/9c/35/1c3f6e62d81f5f0daff1384e6d5e6c5758682a8357ebc765ece2b9def62b/transformers-3.0.0-py3-none-any.whl (754kB)\n","\r\u001b[K     |▍                               | 10kB 25.1MB/s eta 0:00:01\r\u001b[K     |▉                               | 20kB 17.0MB/s eta 0:00:01\r\u001b[K     |█▎                              | 30kB 10.2MB/s eta 0:00:01\r\u001b[K     |█▊                              | 40kB 8.7MB/s eta 0:00:01\r\u001b[K     |██▏                             | 51kB 7.9MB/s eta 0:00:01\r\u001b[K     |██▋                             | 61kB 7.7MB/s eta 0:00:01\r\u001b[K     |███                             | 71kB 8.7MB/s eta 0:00:01\r\u001b[K     |███▌                            | 81kB 9.1MB/s eta 0:00:01\r\u001b[K     |████                            | 92kB 8.6MB/s eta 0:00:01\r\u001b[K     |████▍                           | 102kB 7.7MB/s eta 0:00:01\r\u001b[K     |████▊                           | 112kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████▏                          | 122kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████▋                          | 133kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████                          | 143kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████▌                         | 153kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████                         | 163kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████▍                        | 174kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████▉                        | 184kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████▎                       | 194kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████▊                       | 204kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████▏                      | 215kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████▌                      | 225kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████                      | 235kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████▍                     | 245kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████▉                     | 256kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████▎                    | 266kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████▊                    | 276kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████▏                   | 286kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████▋                   | 296kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████                   | 307kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████▌                  | 317kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████                  | 327kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████▎                 | 337kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████▊                 | 348kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████▏                | 358kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████▋                | 368kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████                | 378kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████▌               | 389kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████               | 399kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████▍              | 409kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████▉              | 419kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████▎             | 430kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████▊             | 440kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████             | 450kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████▌            | 460kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████            | 471kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████▍           | 481kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████▉           | 491kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████▎          | 501kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████▊          | 512kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████▏         | 522kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████▋         | 532kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████         | 542kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████▌        | 552kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████▉        | 563kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████████▎       | 573kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████████▊       | 583kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▏      | 593kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████████▋      | 604kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████████      | 614kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████████▌     | 624kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████████     | 634kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▍    | 645kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████████▉    | 655kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▎   | 665kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████████████▋   | 675kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████   | 686kB 7.7MB/s eta 0:00:01\r\u001b[K     |█████████████████████████████▌  | 696kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████  | 706kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▍ | 716kB 7.7MB/s eta 0:00:01\r\u001b[K     |██████████████████████████████▉ | 727kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▎| 737kB 7.7MB/s eta 0:00:01\r\u001b[K     |███████████████████████████████▊| 747kB 7.7MB/s eta 0:00:01\r\u001b[K     |████████████████████████████████| 757kB 7.7MB/s \n","\u001b[?25hRequirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (4.41.1)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (3.0.12)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (2019.12.20)\n","Collecting sentencepiece\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/f5/99/e0808cb947ba10f575839c43e8fafc9cc44e4a7a2c8f79c60db48220a577/sentencepiece-0.1.95-cp37-cp37m-manylinux2014_x86_64.whl (1.2MB)\n","\u001b[K     |████████████████████████████████| 1.2MB 15.5MB/s \n","\u001b[?25hCollecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/75/ee/67241dc87f266093c533a2d4d3d69438e57d7a90abb216fa076e7d475d4a/sacremoses-0.0.45-py3-none-any.whl (895kB)\n","\u001b[K     |████████████████████████████████| 901kB 35.4MB/s \n","\u001b[?25hCollecting tokenizers==0.8.0-rc4\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/f7/82/0e82a95bd9db2b32569500cc1bb47aa7c4e0f57aa5e35cceba414096917b/tokenizers-0.8.0rc4-cp37-cp37m-manylinux1_x86_64.whl (3.0MB)\n","\u001b[K     |████████████████████████████████| 3.0MB 54.6MB/s \n","\u001b[?25hRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (20.9)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from transformers==3.0) (1.19.5)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==3.0) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==3.0) (1.24.3)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==3.0) (2020.12.5)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers==3.0) (3.0.4)\n","Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==3.0) (1.15.0)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==3.0) (1.0.1)\n","Requirement already satisfied: click in /usr/local/lib/python3.7/dist-packages (from sacremoses->transformers==3.0) (7.1.2)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->transformers==3.0) (2.4.7)\n","Installing collected packages: sentencepiece, sacremoses, tokenizers, transformers\n","Successfully installed sacremoses-0.0.45 sentencepiece-0.1.95 tokenizers-0.8.0rc4 transformers-3.0.0\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"GucX2QwMSNbF","executionInfo":{"status":"ok","timestamp":1619834557224,"user_tz":-420,"elapsed":8608,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["import torch\n","import torch.nn as nn\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import classification_report\n","import transformers\n","from transformers import AutoModel, BertTokenizerFast\n","\n","# specify GPU\n","device = torch.device(\"cuda\")"],"execution_count":19,"outputs":[]},{"cell_type":"code","metadata":{"id":"sPTW1c3uBF8x","executionInfo":{"status":"ok","timestamp":1619835259068,"user_tz":-420,"elapsed":598,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["from sklearn.model_selection import train_test_split\n","sentences_train, sentences_test, y_train, y_test = train_test_split(list(data['title']), list(data['class']), train_size=0.8, random_state=1, stratify=data['class'])"],"execution_count":20,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":162,"referenced_widgets":["91a731f098024fa39add4f94faeeb10e","613efca4f8db4834b30ae5baea57ba11","49681ab8a5d944be87cf18a72c16d433","7c92455760a24a478cd4376cdcff2a45","1d7c0716c04242d58137cda6bdaeafdf","eb2225cfa61b43f88cfe300a59d9712d","f9e56e405b0a4ad8a01aca7882d2e7bc","b375b3b4bdcc4bf58d1e58c1a0500b05","bec05a68695746b1bbdf26ecb1f7d595","5e208480b2d74e86814211cc1fe221c5","84aae9d3e3684ca9ad1c8845d640e052","c2890180dbbc44a7bbe1f8010890f95d","009edcf0858b4819b59c4d6efd269a19","40d48b6c759b49f5b7c22c84de54059c","b2a580b9e08b487ca070d228fe08d230","f31713c5f4bd4ce8added6a72a1fa980","fc4c5d35db7f451ca995c38ad890163c","1a6b71247bf44927b2a0b989733b4979","4f4455d5b9df4bfe831caf3d486bc3e9","0d28697acf8247188df1615d7632fc8b","cb5006f8b56f4f4ea09d419c0c276f92","cff6f9bb7365429dbe61cb475594e903","e5a62c5c73694e30b364e626ab58cc28","a5ce3547546049179c5c9e21092fbb1e"]},"id":"7a3R48ELSXPh","executionInfo":{"status":"ok","timestamp":1619835273592,"user_tz":-420,"elapsed":13588,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"ca18905d-8986-49cd-d2c0-9c9004ae7c52"},"source":["bert = AutoModel.from_pretrained('bert-base-uncased')\n","tokenizer = BertTokenizerFast.from_pretrained('bert-base-uncased')"],"execution_count":21,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"91a731f098024fa39add4f94faeeb10e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=433.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"bec05a68695746b1bbdf26ecb1f7d595","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=440473133.0, style=ProgressStyle(descri…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"fc4c5d35db7f451ca995c38ad890163c","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=231508.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"36eqysX8TsIS","executionInfo":{"status":"ok","timestamp":1619835281055,"user_tz":-420,"elapsed":691,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["tokens_train = tokenizer.batch_encode_plus(\n","    sentences_train,\n","    max_length = 8,\n","    pad_to_max_length=True,\n","    truncation=True\n",")\n","\n","tokens_test = tokenizer.batch_encode_plus(\n","    sentences_test,\n","    max_length = 8,\n","    pad_to_max_length=True,\n","    truncation=True\n",")"],"execution_count":22,"outputs":[]},{"cell_type":"code","metadata":{"id":"mkem_9MTUhM4","executionInfo":{"status":"ok","timestamp":1619835282410,"user_tz":-420,"elapsed":907,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["train_seq = torch.tensor(tokens_train['input_ids'])\n","train_mask = torch.tensor(tokens_train['attention_mask'])\n","train_y = torch.tensor(y_train) \n","\n","test_seq = torch.tensor(tokens_test['input_ids'])\n","test_mask = torch.tensor(tokens_test['attention_mask'])\n","test_y = torch.tensor(y_test) "],"execution_count":23,"outputs":[]},{"cell_type":"code","metadata":{"id":"LRpGCakHV8yh","executionInfo":{"status":"ok","timestamp":1619835283392,"user_tz":-420,"elapsed":846,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler\n","\n","batch_size = 32\n","train_data = TensorDataset(train_seq, train_mask, train_y)\n","train_sampler = RandomSampler(train_data)\n","train_dataloader = DataLoader(train_data, sampler=train_sampler, batch_size=batch_size)\n","test_data = TensorDataset(test_seq, test_mask, test_y)\n","test_sampler = SequentialSampler(test_data)\n","test_dataloader = DataLoader(test_data, sampler = test_sampler, batch_size=batch_size)"],"execution_count":24,"outputs":[]},{"cell_type":"code","metadata":{"id":"jc9K8enjWU3z","executionInfo":{"status":"ok","timestamp":1619835284471,"user_tz":-420,"elapsed":893,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["for param in bert.parameters():\n","    param.requires_grad = True"],"execution_count":25,"outputs":[]},{"cell_type":"code","metadata":{"id":"2vA9lfVkW79B","executionInfo":{"status":"ok","timestamp":1619835285557,"user_tz":-420,"elapsed":1011,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["class BERT_Arch(nn.Module):\n","\n","    def __init__(self, bert):\n","      super(BERT_Arch, self).__init__()\n","      self.bert = bert       \n","      self.dropout = nn.Dropout(0.1)      \n","      self.relu =  nn.ReLU()\n","      self.fc1 = nn.Linear(768,512)      \n","      self.fc2 = nn.Linear(512,2)\n","      self.softmax = nn.LogSoftmax(dim=1)\n","\n","    def forward(self, sent_id, mask):\n","      _, cls_hs = self.bert(sent_id, attention_mask=mask)\n","      x = self.fc1(cls_hs)\n","      x = self.relu(x)\n","      x = self.dropout(x)\n","      x = self.fc2(x)      \n","      x = self.softmax(x)\n","      return x"],"execution_count":26,"outputs":[]},{"cell_type":"code","metadata":{"id":"8pZKJe8nXY8S","executionInfo":{"status":"ok","timestamp":1619835298157,"user_tz":-420,"elapsed":12016,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["model = BERT_Arch(bert)\n","model = model.to(device)"],"execution_count":27,"outputs":[]},{"cell_type":"code","metadata":{"id":"vOtNAYu_X1A4","executionInfo":{"status":"ok","timestamp":1619835324294,"user_tz":-420,"elapsed":1077,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["from transformers import AdamW\n","optimizer = AdamW(model.parameters(), lr = 1e-5)         "],"execution_count":28,"outputs":[]},{"cell_type":"code","metadata":{"id":"_7FEr6YNYR1X","executionInfo":{"status":"ok","timestamp":1619835326018,"user_tz":-420,"elapsed":635,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["cross_entropy  = nn.NLLLoss() \n","epochs = 5"],"execution_count":29,"outputs":[]},{"cell_type":"code","metadata":{"id":"Y-JTsla5ZNqx","executionInfo":{"status":"ok","timestamp":1619835328631,"user_tz":-420,"elapsed":627,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["def train():\n","  \n","  model.train()\n","  total_loss, total_accuracy = 0, 0  \n","  total_preds=[]\n","  \n","  for step,batch in enumerate(train_dataloader):    \n","    if step % 50 == 0 and not step == 0:\n","      print('  Batch {:>5,}  of  {:>5,}.'.format(step, len(train_dataloader)))\n","\n","    batch = [r.to(device) for r in batch]\n","    sent_id, mask, labels = batch\n","    model.zero_grad()        \n","    preds = model(sent_id, mask)\n","    loss = cross_entropy(preds, labels)\n","    total_loss = total_loss + loss.item()\n","    loss.backward()\n","    torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n","    optimizer.step()\n","    preds=preds.detach().cpu().numpy()\n","    total_preds.append(preds)\n","  avg_loss = total_loss / len(train_dataloader)\n","  total_preds  = np.concatenate(total_preds, axis=0)\n","  return avg_loss, total_preds\n"],"execution_count":30,"outputs":[]},{"cell_type":"code","metadata":{"id":"fvzVreeDZoGo","executionInfo":{"status":"ok","timestamp":1619835388343,"user_tz":-420,"elapsed":646,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["def evaluate():\n","\n","  print(\"\\nEvaluating...\")\n","  \n","  model.eval()\n","  total_loss, total_accuracy = 0, 0  \n","  total_preds = []\n","  \n","  for step,batch in enumerate(test_dataloader):    \n","    if step % 50 == 0 and not step == 0:      \n","      elapsed = format_time(time.time() - t0)            \n","      print('  Batch {:>5,}  of  {:>5,}.'.format(step, len(val_dataloader)))\n","    batch = [t.to(device) for t in batch]\n","    sent_id, mask, labels = batch\n","    with torch.no_grad():      \n","      preds = model(sent_id, mask)\n","      loss = cross_entropy(preds,labels)\n","      total_loss = total_loss + loss.item()\n","      preds = preds.detach().cpu().numpy()\n","      total_preds.append(preds)\n","  avg_loss = total_loss / len(test_dataloader) \n","  total_preds  = np.concatenate(total_preds, axis=0)\n","  return avg_loss, total_preds\n"],"execution_count":32,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"xyRcLzm7aHna","executionInfo":{"status":"ok","timestamp":1619835420041,"user_tz":-420,"elapsed":25500,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"f7e709c3-c0b5-4895-8bca-bfd51d223a4b"},"source":["best_valid_loss = float('inf')\n","train_losses=[]\n","valid_losses=[]\n","for epoch in range(epochs):\n","    print('\\n Epoch {:} / {:}'.format(epoch + 1, epochs))    \n","    train_loss, _ = train()\n","    valid_loss, _ = evaluate()    \n","    if valid_loss < best_valid_loss:\n","        best_valid_loss = valid_loss\n","        torch.save(model.state_dict(), 'saved_weights.pt')    \n","    train_losses.append(train_loss)\n","    valid_losses.append(valid_loss)\n","    print(f'\\nTraining Loss: {train_loss:.3f}')\n","    print(f'Validation Loss: {valid_loss:.3f}')\n","\n"],"execution_count":33,"outputs":[{"output_type":"stream","text":["\n"," Epoch 1 / 5\n","\n","Evaluating...\n","\n","Training Loss: 0.645\n","Validation Loss: 0.574\n","\n"," Epoch 2 / 5\n","\n","Evaluating...\n","\n","Training Loss: 0.493\n","Validation Loss: 0.413\n","\n"," Epoch 3 / 5\n","\n","Evaluating...\n","\n","Training Loss: 0.334\n","Validation Loss: 0.372\n","\n"," Epoch 4 / 5\n","\n","Evaluating...\n","\n","Training Loss: 0.250\n","Validation Loss: 0.387\n","\n"," Epoch 5 / 5\n","\n","Evaluating...\n","\n","Training Loss: 0.170\n","Validation Loss: 0.439\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Ygnf4aawaom_","executionInfo":{"status":"ok","timestamp":1619835421563,"user_tz":-420,"elapsed":1503,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"ba2ec341-45c2-4d9c-fafa-b35214a4c45b"},"source":["path = 'saved_weights.pt'\n","model.load_state_dict(torch.load(path))"],"execution_count":34,"outputs":[{"output_type":"execute_result","data":{"text/plain":["<All keys matched successfully>"]},"metadata":{"tags":[]},"execution_count":34}]},{"cell_type":"code","metadata":{"id":"rsrxHwTjasC1","executionInfo":{"status":"ok","timestamp":1619835704085,"user_tz":-420,"elapsed":1131,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["with torch.no_grad():\n","  train_preds = model(train_seq.to(device), train_mask.to(device))\n","  train_preds = train_preds.detach().cpu().numpy()\n","  preds = model(test_seq.to(device), test_mask.to(device))\n","  preds = preds.detach().cpu().numpy()"],"execution_count":43,"outputs":[]},{"cell_type":"code","metadata":{"id":"-fi3d-Fua-70","executionInfo":{"status":"ok","timestamp":1619835704407,"user_tz":-420,"elapsed":537,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["y_test = np.array(y_test)\n","y_train = np.array(y_train)"],"execution_count":44,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wxrV3ohMuaAO","executionInfo":{"status":"ok","timestamp":1619835705665,"user_tz":-420,"elapsed":861,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"e641d108-4b84-40aa-a22c-e682cb35363c"},"source":["train_preds = np.argmax(train_preds, axis = 1)\n","print('training report')\n","print(classification_report(train_y, train_preds))"],"execution_count":45,"outputs":[{"output_type":"stream","text":["training report\n","              precision    recall  f1-score   support\n","\n","           0       0.91      0.96      0.93       613\n","           1       0.97      0.93      0.95       869\n","\n","    accuracy                           0.94      1482\n","   macro avg       0.94      0.94      0.94      1482\n","weighted avg       0.94      0.94      0.94      1482\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"0xZ95byzbBne","executionInfo":{"status":"ok","timestamp":1619835686122,"user_tz":-420,"elapsed":699,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"738f4c8c-28e9-4c71-f899-274a36cfa127"},"source":["preds = np.argmax(preds, axis = 1)\n","print('test report')\n","print(classification_report(test_y, preds))"],"execution_count":39,"outputs":[{"output_type":"stream","text":["test report\n","              precision    recall  f1-score   support\n","\n","           0       0.80      0.84      0.82       153\n","           1       0.88      0.85      0.87       218\n","\n","    accuracy                           0.85       371\n","   macro avg       0.84      0.84      0.84       371\n","weighted avg       0.85      0.85      0.85       371\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"LXqmpMwsdvu8","executionInfo":{"status":"ok","timestamp":1619814459012,"user_tz":-420,"elapsed":638,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}}},"source":["df = pd.DataFrame({'text': list(sentences_test), 'sentiment': preds})"],"execution_count":40,"outputs":[]},{"cell_type":"code","metadata":{"id":"Cl_Cb-zWvWM9"},"source":["#from test report, the test accuracy score is 0.85. \n","#precision is 0.80 for negative sentiments (80 percent of the time, model predicts true positive) and 0.88 for positive sentiments (88 percent of the time, model predicts true positive)\n","#recall shows that the model classifies class 0 (negative sentiments) correctly 84 percent of the time, and classifies class 1 correctly 85 percent of the time\n","#numbers might not be super close to one, shows that it is not over fitting\n","#this might be because data ratio is not divided evenly, which is reflected through the support numbers where there are fewer negative sentiments data points (fewer class 0 than class 1)\n","#this is also true in training data"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"colab":{"base_uri":"https://localhost:8080/","height":388},"id":"eIewxwODd0Gu","executionInfo":{"status":"ok","timestamp":1619814467762,"user_tz":-420,"elapsed":764,"user":{"displayName":"Joy Leeswadtrakul","photoUrl":"","userId":"15282746492468197181"}},"outputId":"efe7eaf2-b6c3-4bf6-a082-f37178a1e8b5"},"source":["df"],"execution_count":41,"outputs":[{"output_type":"execute_result","data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>sentiment</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>i love all of you.</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>amc yolo update.. ape love movies 🦍🦍🦍</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>my own \"if gme hits..\" promise that i hope i f...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>i like the stock and free tendies</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>gme the high risk high reward play</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>366</th>\n","      <td>a bit delayed here in oz but i'm fucking in yo...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>367</th>\n","      <td>32 gme shares at $250 a share</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>368</th>\n","      <td>nok isn't banned 🚀 🚀 🚀 🚀 🚀 🚀 🚀 🚀 🚀</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>369</th>\n","      <td>dont let the vultures win on amc.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>370</th>\n","      <td>am i a certified retard now?</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>371 rows × 2 columns</p>\n","</div>"],"text/plain":["                                                  text  sentiment\n","0                                   i love all of you.          1\n","1                amc yolo update.. ape love movies 🦍🦍🦍          1\n","2    my own \"if gme hits..\" promise that i hope i f...          1\n","3                    i like the stock and free tendies          1\n","4                   gme the high risk high reward play          0\n","..                                                 ...        ...\n","366  a bit delayed here in oz but i'm fucking in yo...          0\n","367                      32 gme shares at $250 a share          1\n","368                 nok isn't banned 🚀 🚀 🚀 🚀 🚀 🚀 🚀 🚀 🚀          1\n","369                  dont let the vultures win on amc.          0\n","370                       am i a certified retard now?          0\n","\n","[371 rows x 2 columns]"]},"metadata":{"tags":[]},"execution_count":41}]}]}